====== FINDOLOGIC-Integration für Shopware ======

===== Wichtige Hinweise =====

==== Kompatibilität ====

Das Modul steht derzeit für Shopware 3 und 4 zur Verfügung.

Soll das Plugin über das Shopware-Backend installiert werden, muss das Verzeichnis ''/engine/Shopware/Plugins/Community/'' und seine Unterordner über die vollen Schreibrechte verfügen (777) sowie auf dem Server die ZIP-Unterstützung installiert und aktiviert sein.

===== Shopware 4 / Shopware 5 - Installation des Moduls =====

==== Schritt 1: Download des Plugins ====

Hier können Sie das unverschlüsselte Modul für [[http://demo.findologic.com/plugins/SwpFindologic_4.01.29.zip|Shopware 4]] bzw. [[http://demo.findologic.com/plugins/SwpFindologic_5.01.04.zip|Shopware 5]] herunterladen und manuell installieren.


==== Schritt 2: Einstellungen im Shop-Backend ====

Nachdem Sie das Plugin installiert wurde, können Sie es unter dem Menüpunkt "Einstellungen -> Plugin-Manager" bearbeiten.

{{:fl:integration:shopware_plugin.png|}}
  * **Aktiv**: Damit aktivieren/deaktivieren Sie das Plugin.
  * Bei **Shopkey** und **FINDOLOGIC-Service-URL** geben Sie die selben Daten ein, die in Ihrem ''[[https://secure.findologic.com/login.symfony/web/app.php/login|FINDOLOGIC-Kundenaccount]]'' im Menüpunkt "Stammdaten" hinterlegt sind.
  * **Export-Limit** pro Step: Voreingestellt sind 100 Datensätze pro Exportschritt.
  * **Anzahl der Ergebnisse** pro Seite (Mehrere Einträge durch Semikolon (;) trennen): Legen Sie die Anzahl der Suchergebnisse pro Seite fest. Wenn Sie mehrere Werte angeben, können die Nutzer unter diesen Werten selbst auswählen.
  * **Autocomplete** aktivieren?: Autovervollständigung der Suchbegriffe an- oder abschalten.
  * **Suchergebnis-Logo**: Sie können zwischen mehreren Darstellungsweisen des FindologicLogos auswählen.
  * **Export-Unterverzeichnis**: Wenn Sie die Export-Datei nicht im Root-Verzeichnis ablegen möchten können Sie hier ein Unterverzeichnis angeben. Achten Sie bitte darauf, dass das Verzeichnis existiert und Schreibrechte gesetzt sind. Geben Sie bitte auch mit einem gewählten Unterverzeichnis keine CSV-URL im FINDOLOGIC Kundenaccount an (siehe weiter unten).
  * **folgendes Datum für Artikelsortierung nutzen**: Das Einstelldatum bzw. Erscheinungsdatum kann Einfluss auf die Sortierung der Artikel nehmen. Wählen Sie hier bitte das für Sie relevante Datum aus (Standard: Einstelldatum)
  * **Plugin für diesen Shop aktivieren**: Sollten Sie mehrere Subshops verwenden aber nicht für jeden einen FINDOLOGIC Service gebucht haben, können Sie hier explizit das FINDOLOGIC Plugin für einen Subshop deaktivieren.

====Schritt 3: Aktivierung====

  * Sobald, das Modul eingerichtet wurde, schreiben Sie ein diesbezügliches Email an support@findologic.com, damit wir Ihre Artikeldaten das erste Mal indizieren können.
  * Nach der ersten Indizierung ist die FINDOLOGIC Suche in Ihrem Shop einsatzbereit.




==== Filter ====

Bitte beachten Sie, dass die Darstellung der Filter in der Datei search.tpl auf Ihrem Server konfiguriert werden muss und die Einstellungen im FINDOLOGIC-Kundenaccount unter "Einstellungen -> Filterkonfiguration" keinen Einfluss auf die Darstellung haben.

===== Einrichtung Shopware 3 =====

==== Download des Moduls ====

Das Modul können Sie im [[http://store.shopware.de/werbung-marketing/findologic-suche|Shopware-Community-Store]] herunterladen.

==== Konfiguration ====

=== Cache leeren ===
Leeren Sie nun den Cache unter ''Einstellungen'' -> ''Shopcache leeren'' -> ''Konfiguration''

{{:fl:integration:schritt1.png|}}

=== Konfiguration anpassen ===
Die Konfiguration der Suche finden Sie unter ''Einstellungen'' -> ''Plugins''. Im Reiter ''Verfügbare Plugins'' gibt es den Eintrag ''FINDOLOGIC-Suche'' -> ''Bearbeiten'' finden Sie die Einstellungen für die FINDOLOGIC-Suche 

{{:fl:integration:schritt2.png|}}

Tragen Sie dort Shopkey und Service-URL ein, diese Werte finden Sie im ''[[https://secure.findologic.com/login.symfony/web/app.php/login|FINDOLOGIC-Kundenaccount]]''

{{:fl:integration:schritt3.png|}}

==== Aktivierung ====

Die Daten werden von FINDOLOGIC automatisch in der Nacht exportiert. Nach Einrichtung des Moduls steht Ihnen die FINDOLOGIC-Suche somit am nächsten Tag zur Verfügung.

==== Smart Suggest ====

[[fl:integration:shopware:smart_suggest|Integration der Smart Suggest bei Shopware]]

==== Filterposition ====

Standardmäßig werden die FINDOLOGIC Filter in der linken Spalte, in der sich üblicherweise auch die Navigation befindet, nahtlos in das Shopdesign eingebunden.
Sollten Sie die Filter in der Mitte positionieren wollen, ist eine kleine Anpassung der Datei ''search.tpl'' nötig.

Entnehmen Sie hierfür das ''<div class="filter_search">'' (mit gesamten Inhalt!) aus dem Block ''frontend_index_left_categories'':

<code>
{block name="frontend_index_left_categories" append}
-----------VON HIER-----------
	<div class="filter_search">
		{if $findologic.selected_filter}
			{* Div mit den, vom Benutzer, ausgewählten Filtern *}
			<div class="FindologicSelectedFilter">
...
...
...
					{/foreach}

					{if $no_more_filter == 'true'}
						{se name="SwpFindologicNofilteravailable"}{/se}
						<script language="javascript" type="text/javascript">
							{literal}
								$('#FindologicMoreFilterContainer').css('display', 'none');
							{/literal}
						</script>
					{/if}
					<br /><div style="clear:both;"></div>
				</div>
			</div>
		</div>
	</div>
-----------BIS HIER-----------
{/block}
</code>

und fügen Sie diesen in den Block ''frontend_index_content'' wieder ein (empfehlenswert über dem if-Block für Promotions).

<code>
		{* Div mit Suchtext, Anzahl der Treffer und dem Findologic-Logo *}
		{* !!! Das Findologic-Logo darf nur gegen 100% Aufpreis entfernt werden !!! *}
		<div class="FindologicResultQuery" style="clear:both;">
			<a target="_blank" href="http://www.findologic.com/"><img src="{$findologic.logo}" /></a>
			<div>{$findologic.query.string}</div>
		</div>

-----------HIER------------------

		{if $findologic.promotion.link && $findologic.promotion.image}
			<div class="FindologicPromotion" style="clear:both;">
				<a href="{$findologic.promotion.link}"><img src="{$findologic.promotion.image}" /></a>
			</div>
		{/if}
</code>


==== Troubleshooting ====

=== Allgemein ===
  * Wie man bei Shopware die Artikel-IDs auslesen kann, um diese bei ''Product-Placements'' zu hinterlegen: Der einfachste Weg um an die Artikel-ID zu gelangen ist aktuell diesen direkt aus der exportierten CSV auszulesen. Die Datei befindet sich im Normalfall unter ''<SHOP_URL>/shop_<SHOP_ID>_findologic.csv''. Hier ist der jeweilige Wert in der Spalte ''id'' der gesuchte.
  * Das ''Livesearch'' Modul, sowie individuelle Anpassungen können zu Inkompatibilitäten mit FINDOLOGIC führen


=== Export ===
  * Damit Artikel exportiert werden, müssen diese "aktiv" und einer Kategorie zugeordnet sein
  * Es muss möglich sein, am Server die Funktion ''unlink'' aufzurufen, da sonst der Export nicht korrekt durchlaufen kann


=== "Licencecheck failed" ===
  * Wenn das Modul nicht installiert werden kann, weil die Lizenz nicht korrekt ist, einfach folgende Anleitung befolgen: [[http://wiki.shopware.de/Aktivierung-Shopware-4_detail_931.html]]
  * Bei einem Modulupdate von Version kleiner 4.01.23 (also Versionen bis einschließlich 4.01.22) auf Version gleich oder größer 4.01.23 (also ab Version 4.01.23) muss beim Shopware Support ein neuer Modul-Lizenzschlüssel beantragt werden; Grund hierfür ist dass die Lizenzierung des Moduls ab Version 4.01.23 verändert wurde und die Kunden nun einen neuen Lizenzschlüssel von Shopware benötigen

=== Artikel wird in Shopware 5 exportiert, aber in der Suche nicht angezeigt ===
  * Wenn ein Artikel korrekt exportiert wird, aber in der Suche nicht erscheint (sozusagen 1 fehlendes angezeigtes Ergebnis), dann sollte man versuchen im Shopware Backend den Artikel zu speichern, danach sollte der Artikel sofort auftauchen. Höchstwahrscheinlich wurde der Artikel dann über eine Warenwirtschaft nicht korrekt angelegt.

=== Artikelnummern die exportiert werden ===

Folgende Felder werden exportiert:

  * Artikelnummer
  * Herstellernummer
  * EAN

dies gilt für Hauptartikel als auch Varianten.

=== Artikel werden im Shop nicht angezeigt ===

Bei Shopware scheint es einen Fehler zu geben wenn Artikel / Varianten kopiert werden. Dabei können Artikel in der Datenbank bestehen bleiben, nicht aber im Shop oder Shopbackend sichtbar sein. Die Artikel werden allerdings wie gewöhnliche Artikel exportiert.

Folgende Vorgehensweise ist dabei zu empfehlen:
  * Prüfen welche Artikel IDs zurückgegeben werden und nicht angezeigt werden
  * CSV nach entsprechenden Artikeln durchsuchen.
  * Gewöhnlicherweise steht in oben beschriebenem Fall hinter dem Artikel-Titel ein "-Copy".
  * Diese Artikel müssen anschließend manuell aus der Shopware Datenbank entfernt werden

=== Suche temporär für einen Shop deaktivieren ===

Um die Suche temporär für einen Shop zu deaktivieren ist es möglich das Plugin global (über die Checkbox) im Plugin-Manager zu aktivieren und beim Konfigurationsparameter "Plugin für diesen Shop aktivieren?" auf Nein zu stellen. Ein Export der Artikeldaten ist somit weiterhin möglich.


