====== FINDOLOGIC Zertifizierungskriterien (Checkliste vor Fertigstellung der Integration/des Moduls) ======

===== Export der Daten =====
  * Die Daten werden zur Gänze UTF-8 kodiert exportiert.
  * Wenn ein Fehler auftritt (interner Fehler, CSV kann nicht erstellt / verändert werden, Timeouts, etc.) **muss** eine entsprechende **Fehlermeldung** ausgegeben werden.
  * Der Shopbetreiber kann konfigurieren ob Artikel und Varianten ohne Bestand exportiert werden und somit über die Suche auffindbar sind oder nicht.
  * Wenn der Export durch ein Passwort geschützt werden kann, kann die Angabe eines Passworts der Export URL mit einem Parameter übergeben werden.
  * Die Angabe der Sprache als ISO-Code kann der Export URL mit einen Parameter übergeben werden (z.B. ''language=de'' für Deutsch). 
  * Attribute und Artikelnummern (EAN, MPN, SKU, ISBN, etc.) von Varianten werden in einem Master Artikel zusammengefasst und exportiert.
  * Es wird nur ein Preis und eine Währung pro Produkt exportiert.
  * Sofern eine Katgorie-Hierarchie aus dem Shop abzuleiten ist, werden Kategorien hierarchisch exportiert.
  * Das Format der exportierten CSV-Datei entspricht den Vorgaben unter [[https://secure.findologic.com/dokuwiki/doku.php?id=fl:csv_format_2_0]]
  * Der Dateiname setzt sich zusammen aus ''findologic_<shopid>_<sprache>.csv'' (z.B. ''findologic_1_de.csv'')
  * Als Pfad zur Export-Datei wird das vom Shopsystem übliche Verzeichnis für Exporte gewählt oder (wenn nicht vorhanden) im Shop-Backend ein Feld zum Einstellen des Export-Pfades zur Verfügung gestellt.

==== Sequentieller Export ====
  * Der Export wird sequentiell (einzelne Aufrufe für Teilmengen des Artikelstands) bereit gestellt.
  * Für den sequentiellen Export wird eine Start-URL bereitgestellt.
  * Die gewünschte Intervallgröße (Anzahl zu exportierender Artikel) kann per URL Parameter (''limit'') übergeben werden.
  * Der gewünschte Offset (erster zu exportierender Artikel) kann per URL Parameter (''start'') übergeben werden.
  * Bei einem Aufruf ohne ''start'' und ''limit'' Parameter werden diese auf Default-Werte (bspw. ''start=0&limit=100'') gesetzt.
  * Die einzelnen Aufrufe leiten bis zum Abschluss des Exports auf die entsprechenden Folgeseiten per Location-Header (HTTP location) weiter.

==== Daten die nicht exportiert werden dürfen ====
Artikel, Varianten und Kategorien haben je nach Shopsystem mehrere Möglichkeiten von der Anzeige im Webshop ausgeschlossen zu werden (= nicht sichtbar).
Typische Faktoren sind hier:
  * Bestand
  * Überverkauf
  * Aktiv / Inaktiv
  * Anzeigen / Nicht anzeigen
Dementsprechend ist beim Export diese Logik nachzubilden und:
  * Ist ein Artikel im Shop nicht sichtbar, darf er nicht exportiert werden.
  * Ist eine Variante im Shop nicht sichtbar, darf sie nicht exportiert werden.
  * Ist eine Kategorie im Shop nicht sichtbar, darf sie nicht exportiert werden.

===== Suche =====
  * Es können mehrere Suchbegriffe eingegeben und an FINDOLOGIC übergeben werden.
  * Es können mehrere Filter gleichzeitig ausgewählt und an FINDOLOGIC übergeben werden.
  * Es können Filter und Suchanfragen mit dem Zeichen ''&'', mehreren Begriffen und Umlauten eingegeben und an FINDOLOGIC übergeben werden.
  * Die Suchanfrage muss UTF-8 und URL kodiert sein.
  * Der Shopkey entspricht der FINDOLOGIC Lizenz der aktuellen Sprache.
  * Ist für die aktuelle Sprache kein Shopkey hinterlegt muss die Suchanfrage von der herkömmlichen Shopsuche bearbeitet werden.
  * Für nicht anzeigbare Artikel muss ein Platzhalter dargestellt werden. ((Die Artikeldaten werden von FINDOLOGIC nur periodisch aktualisiert. Wird ein Artikel in der Zwischenzeit gelöscht oder kann aus anderen Gründen im Shop nicht mehr angezeigt werden fehlt er ansonsten in den Suchergebnissen, wodurch das Layout zerstört werden kann (z.B. werden auf einer Ergebnis-Seite mit 24 Ergebnissen nur 23 angezeigt) ))
  * Bei Änderung der Seitengröße und wechsel auf eine andere Seite (Pagination) müssen aktuell ausgewählte Filter, Suchwort und Sortierungen erhalten bleiben.
  * Das Feld ''userip'' muss bei jeder Suchanfrage an FINDOLOGIC übertragen werden.

==== Mehrsprachigkeit / Subshops / Mandanten ====
  * Der (//Smart Suggest//-) Request URL wird der //Shopkey// Parameter des entsprechenden FINDOLOGIC Service übergeben.
  * Der (//Smart Suggest//-) Request URL wird der //Groups// Parameter des entsprechenden Mandanten übergeben.

===== Ausgabe =====
  * Die HTML Ausgabe muss valide im Sinne der W3C Standards sein (http://validator.w3.org/).
  * Der Shopbetreiber muss eine Auswahlmöglichkeit der Anzahl der Artikel auf der Ergebnisseite konfigurieren können. (Per Default: "12, 24, 48")

==== Filter ====
  * Filter werden in entsprechenden Gruppen in einzelnen Filterboxen zusammengefasst (Kategorie, Hersteller, Preisbereich, Farbe, Größe, etc.).
  * Pro Filter werden die Filterwerte in einem HTML ''<ul>'' Tag (unsorted list) eingebettet ausgegeben und mit einer eindeutigen Id (Bsp. ''fl_filter_vendor'') versehen um Shopbetreibern CSS-Anpassungen zu ermöglichen.
  * Die Ausgabe von Filter und Suchanfragen mit Steuerzeichen und/oder Sonderzeichen (z.B.''ü'' oder ''&'') wird korrekt dargestellt.
  * Ausgewählte Filter sind in einer seperaten Filterbox über den auswählbaren Filtern anzuzeigen.
  * Filter dürfen nicht ausgeben werden, wenn keine weiteren Auswahlmöglichkeiten (zur Ergebnismenge zugeordnete Attribute) mehr zur Verfügung stehen.
  * Der Link "Weitere Filter" darf nicht angezeigt werden, wenn keine weiteren Filter mehr zur Verfügung stehen.
  * Wird ein Filter-Item mit ''<weight>0</weight>'' übergeben, darf und muss dieser Wert nur ausgegeben werden, wenn mindestens ein Child-Item einen weight-Wert größer 0 enthält. 
  * In der Ausgabe des Filters wird der Wert aus ''<display/>'' als Name verwendet
  * Wenn im FINDOLOGIC-Kundenaccount bei den Filtereinstellungen "Häufigkeit anzeigen" aktiviert ist, soll hinter dem Filterwert das Element <frequency /> in Klammern ausgegeben werden. Beispiel: ''Rot (23)''

=== Mehrfachauswahl ===
  * Ist ein Filter vom Typ "Mehrfachauswahl" werden die Filterwerte mit einer führenden Checkbox ausgegeben.
  * Die Checkbox bereits ausgewählte Filterwerte ist angehakt.
  * Ausgewählte Filterwerte können durch einen Klick auf den Filterwert wieder abgewählt werden.

=== Bereichsslider ===

  * Filter vom Typ "Bereichsslider" werden als Slider angezeigt.((Ein Balken mit einem Drag&Drop Handle für das Minimum und einem Handle für das Maximum. Bei Verschiebung eines Handles wird eine neue Suchanfrage abgeschickt. Es wird empfohlen das jQuery UI Plugin - Slider zu verwenden.))

=== Farbfilter ===
  * Für Filter mit Farbwerten kann ein //Color-Picker// zur Darstellung des Filters verwendet werden.
  * Die Hintergrundfarben der Filterwerte Links entsprechen den übergebenen HTML Farben.
  * Die Hintergrundbilder der Filterwerte Links entsprechen den übergebenen Bildern.
  * Sollte keine Farbe übergeben werden und das Hintergrundbild nicht erreichbar sein, wird ein Fragezeichen auf weißem Hintergrund ausgegeben.

=== Filter mit Bildern (Logos) ===
  * Für Filter mit Bildern kann ein Filter mit Darstellung der übergebenen Bilder inklusive Bezeichnung und Häufigkeit verwendet werden.
  * Bild, Name und Häufigkeit können mittels CSS-Selektoren angesprochen und ein bzw. ausgeblendet werden.
  * Das "alt" Attribut beinhaltet den Filternamen.

==== Sortierungen ====
  * Folgende Sortiermöglichkeiten (unter Einhaltung der angegebenen Bezeichnungen) werden dem Endkunden angeboten:
    * Deutsch: Beste Treffer((es wird in diesem Fall keine Sortierung mitgegeben, so dass die im FINDOLOGIC-Kundenaccount eingestellte Sortierung verwendet wird)), Günstigste zuerst, A-Z, Topseller zuerst, Neuheiten zuerst
    * Englisch: Most relevant((es wird in diesem Fall keine Sortierung mitgegeben, so dass die im FINDOLOGIC-Kundenaccount eingestellte Sortierung verwendet wird)), Lowest price first, A-Z, Topseller first, Latest products first

===== Fallback-Mechanismus =====
  * Vor jeder Suchanfrage wird ein //Alivetest// an FINDOLOGIC gesendet.
  * Bei der Rückgabe von ''alive'' wird die eigentliche Suchanfrage an den FINDOLOGIC Service gesendet.
  * Bei jeder anderen Rückgabe als ''alive'' wird die Suchanfrage von der herkömmlichen Shopsuche bearbeitet.((Wenn der Fallback-Mechanismus nicht ordnungsgemäß funktioniert **darf** die FINDOLOGIC Suche in keinem produktiven Shop eingesetzt werden.))
  * Bei der Rückgabe eines ungültigen XML muss die Suchanfrage ebenfalls von der herkömmlichen Shopsuche bearbeitet werden.

===== Smart Suggest =====
  * Bei der Auswahl eines Artikels wird die Suche mit dem Parameter ''identifier=<ArtikelID>'' abgeschickt.
  * Wurde die Suche mit dem Parameter ''identifier'' abgeschickt und wird nur ein Ergebnis zurückgegeben wird direkt auf die Artikel-Detailseite weitergeleitet.
  * Es können Suchanfragen mit ''&'', Leerzeichen und Umlauten eingegeben und an FINDOLOGIC übergeben werden. 
  * Artikelbilder und Herstellerbilder können angezeigt werden.
  * Die Anzeige der Typen (Kategorie, Hersteller, Produkt) erfolgt gruppiert nach Typ.
  * Die eingegeben Zeichen werden bei den Resultaten mit Highlighting angezeigt.
  * Die Auswahl eines Ergebnisses ist sowohl per Klick als auch mit Enter möglich.
  * Bei Auswahl einer Kategorie / eines Herstellers, muss eine Verlinkung auf den Filter erfolgen.
  * Wenn FINDOLOGIC aktiv ist, aber ohne Smart Suggest, dürfen keine Suchvorschläge geliefert werden. Auch eine shopinterne Smart Suggest darf nicht aktiv sein.
  * Der Smart Suggest-Script Tag wird mit dem entsprechenden MD5-Hash des //Shopkeys// des entsprechenden FINDOLOGIC Service erzeugt und ausgegeben.
  * Alle Parameter die an den Smart Suggest-Proxy übergeben werden, müssen zu FINDOLOGIC durchgereicht werden.

===== Shop-Backend =====
  * Pro Sprache im Shop, ist im Adminbereich die Angabe einer Service-URL zum FINDOLOGIC-Suchservice möglich.
  * Pro Sprache im Shop, ist im Adminbereich die Angabe eines //Shopkeys// (eindeutiger Schlüssel einer FINDOLOGIC Lizenz) möglich.
  * Bei //Shopkey// und Service-URL dürfen umgebende Leerzeichen nicht gespeichert werden ('''   service.findologic.com   ''' -> '''service.findologic.com''')
  * Der Shopbetreiber kann aus folgenden Logo Varianten (zu finden unter [[https://secure.findologic.com/dokuwiki/doku.php?id=fl:logo_verwendung]]) über eine Auswahlbox auswählen:
    * 'normal'
    * 'rot grau'
    * 'grau'
    * 'normal transparent'
    * 'rot grau transparent'
    * 'grau transparent'
    * 'english banner'
  * Der Shopbetreiber kann das Logo deaktivieren mit einem Hinweis: //Nur bei Buchung **ohne** "FINDOLOGIC Branding".//

===== Landingpages =====
  * Wird bei der Rückgabe einer Suchanfrage eine Landingpage zurückgegeben, wird auf die übergebene URL automatisch weitergeleitet.((Bei XML-Output wird beispielsweise das Element ''%%<landingPage link="http://www.example.com/imprint">%%'' zurückgeliefert.))

===== Promotions =====
  * Wird bei der Rückgabe einer Suchanfrage eine Promotion zurückgegeben, wird diese als Banner mit Verlinkung, über den Suchergebnissen ausgegeben.((Bei XML-Output wird beispielsweise das Element ''%%<promotion image="http://www.example.com/special-offer.jpg" link="http://www.example.com/special-offer" />%%'' zurückgeliefert.))

===== Sonstiges =====
  * Das FINDOLOGIC-Logo darf nur und muss angezeigt und verlinkt werden, wenn die Ergebnisse auch von FINDOLOGIC stammen.((Bei Buchung von "FINDOLOGIC ohne Logo und Link" kann das Logo ausgeblendet werden.))
  * Bei Aufruf der Suche mit dem URL-Parameter ''fallback=1'' muss die Suche auf die Standard-Shopsuche umschalten.
  * Die Installation des Moduls muss dokumentiert sein.
  * Falls Mandanten vom Shopsystem unterstützt werden, muss eine korrekte Übergabe des Mandanten erfolgen.
  * Um die Qualität der Suchergebnisse sicherzustellen, darf kein Caching der Suchergebnisse verwendet werden.
  * Beim Request wird die Revision-Number der aktuellen Modulversion mitgeschickt.

====== Weiterführende Dokumentation ======

  * Allgemeines
    * [[fl:integration:eigenes_sonstiges|Übersicht]]
    * [[fl:integration:checklist_modul|Checklist]]
  * Export
    * [[fl:integration:export|Export Dokumentation]]
    * [[fl:csv_format_2_0|CSV Formatbeschreibung]]
  * Request
    * [[fl:integration:request|Dokumentation des Requests]]
  * Rückgabe
    * [[fl:integration:response:xml|Beschreibung des XML Formats]]
    * [[fl:integration:response:html|Dokumentation der HTML Rückgabe]]
    * [[fl:template_manager_2_0|Beschreibung der Templates]]
  * Smart Suggest 
    * [[fl:integration:smart_suggest|Einbindung der Smart Suggest]]
  * Navigation
    * [[fl:navigation|Implementierungsanleitung der Navigation]]