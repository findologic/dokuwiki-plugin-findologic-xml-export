====== Template-Manager ======
Mit dem Template-Manager können Sie die Anzeige der Suchergebnisse ganz an Ihre Bedürfnisse anpassen!
Der Suchservice FINDOLOGIC verwendet smarty-Templates um die HTML-Antwort auf die Suchanfragen zu generieren.
Der Template-Manager erlaubt den Zugriff auf diese smarty-Templates, um spezielle Anpassungen vorzunehmen, die mit Style-Sheets alleine nicht möglich sind.

Verwenden Sie ein spezielles Shopsystem, so können wir Ihnen die Suchergebnisse auch in XML liefern. Sehr oft wird der Template-Manager auch dahingehend verwendet, um die Filter als HTML zu liefern und die Suchergebnisse als Artikel-IDs zurück zuliefern. Auf der Shopseite werden die Artikel-IDs dann ausgelesen und regulär dargestellt.

===== Template-Plugins =====

Für die einfache Gestaltung der Templates stellt FINDOLOGIC eine Reihe an fertigen Plugins zur Verfügung.\\
Die Dokumentation hierfür finden Sie [[fl:template_manager:plugins|hier]].

===== Manager-Interface =====

Über den [[https://secure.findologic.com/login/|Kundenbereich]] ist der Zugriff auf den Template-Manager möglich.

{{:fl:template_manager.png|}}

==== Aktionen ====

Mit einem Klick auf den Button //bearbeiten// kann die jeweilige Template-Datei angepasst werden.

=== Versions-Kontrolle ===

Sind Änderungen gespeichert, stehen weitere Aktionen zur Verfügung. Datum und Uhrzeit der aktuellen Version steht direkt unter dem Template-File Namen.

  * **Version wiederherstellen**: Erlaubt das Zurückspielen einer älteren Version, wenn Änderungen wieder rückgängig gemacht werden sollen.
    * Jede Version ist mit Datum und Uhrzeit gekennzeichnet.
    * Bei einem Klick auf den Link //ansehen// der angeführten Versionen, kann die Version angezeigt werden und wiederhergestellt werden.
    * Bei jeder Änderung, auch bei einer Rückstellung, wird eine neue Version erzeugt.

Geänderte Template-Files sind sofort wirksam.

===== Templates =====
  * Jede smarty-Template enthält html, wie ''<p> Text ... </p>'', und Template-Tags, wie ''{$RESULT[i].PRICE}''.
  * Eine genaue Beschreibung des smarty-Systems ist hier zu finden: http://www.smarty.net/manual/de/
  * HTML-Tags werden so eingerückt, wie sie in den Suchergebnissen erscheinen sollen.
  * Template-Tags über ganze Zeilen sollten nicht eingerückt werden, um die Einrückung im Ergebnis zu erhalten.
  * Die neue Version unseres Templates verwendet für die Suchfunktion nur mehr ein Template (''html2a.tpl'' oder ''plenty2.tpl'').
  * Der Suchservice setzt smarty-Variablen, entsprechend des Suchergebnisses zur Verwendung in den Templates.
  * GET-Parameter, die vom Such-Service nicht verwendet werden, stehen den Templates zur Verfügung, damit die Parameter in allen erzeugten Links enthalten sein können.
  * Standardmäßig verwendet der Suchservice folgende GET-Parameter:
    * ''query'': Suchanfragentext
    * ''attrib'': ausgewählte Attributsfilter
    * ''price'': ausgewählter Mindest- und Höchstpreis

{{:fl:template_editor.jpg|}}

==== Template-Variablen ====
Folgende smarty-Variablen werden vom FINDOLOGIC-Suchservice gesetzt:
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''TOTAL_RESULTS'' | integer | Gesamtzahl der gefundenen Ergebnisse |
| ''CATEGORY_COUNT'' | integer | Anzahl der vom Service gelieferten Kategoriefilter |
| ''VENDOR_COUNT'' | integer | Anzahl der vom Service gelieferten Herstellerfilter |
| ''PRICE_COUNT'' | integer | Anzahl der vom Service gelieferten Preisfilter |
| ''MORE_FILTERS_COUNT'' | integer | Anzahl der vom Service gelieferten weiteren Filterkategorien (exklusive Kategorie, Hersteller, Preis) |
| ''QUERY'' | string | Suchanfragentext |
| ''PRICE_MIN'' | string | ausgewählter Mindestpreis, sonst leer |	 
| ''PRICE_MAX'' | string | ausgewählter Maximalpreis, sonst leer |
| ''PARAMETER.attrib'' | struct | Struktur aller ausgewählter Filter |
| ''PARAMETER.more'' | struct | Struktur der zusätzlichen GET-Parameter, die nicht vom Service verwendet werden |

==== Result Variablen ====
Die Datei **results.tpl** enthält die Erzeugung der Ergebnisliste.

Die folgenden smarty-Variablen werden dafür gesetzt:
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''REMOVE_ALL_FILTERS'' | string | URL zu den Suchergebnissen, mit allen bisherigen Filtern entfernt |
| ''RESULT'' | array | Array der Suchergebnisse |

=== Items des RESULT Arrays ===
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''ITEM.ID'' | string | eindeutige Artikel-ID, wie in der [[csv_format_2_0|csv]] übergeben |
| ''ITEM.ORDERNUMBER'' | string | Artikelnummer, wie in der [[csv_format_2_0|csv]] übergeben |
| ''ITEM.TITLE'' | string | Artikelname mit Hervorhebung der gefundenen Worte ''flemphasis''((Sofern Highlighting des Suchbegriffes aktiviert)) |
| ''ITEM.TITLE_WITHOUT_HIGHLIGHTING'' | string | Artikelname ohne Hervorhebung der gefundenen Worte|
| ''ITEM.SUMMARY'' | string | Kurzbeschreibung mit Hervorhebung der gefundenen Worte |
| ''ITEM.PRICE'' | number | aktuell gültiger Brutto-Preis des Artikels, z.B. Angebotspreis |
| ''ITEM.OVERRIDDEN_PRICE'' | number | Normalpreis, UVP o.ä |
| ''ITEM.IMAGE'' | string | URL des Artikel-Thumbnail-Bildes |
| ''ITEM.URL'' | string | URL der Artikeldetailseite |
| ''ITEM.TAX_RATE'' | number | Steuersatz des Artikels |
| ''ITEM.PROPERTIES'' | struct | Struktur mit den Inhalten der optionalen Spalten der CSV ((Z.B.: Ist in der CSV eine zusätzliche Spalte ''detail'' für jeden Artikel definiert, enthält ''ITEM.PROPERTIES.detail'' den entsprechenden Wert; weiterhin ist in ''ITEM.PROPERTIES.vendor'' der Inhalt des ''vendor''-Attributs gesetzt)) |

==== Filter Variablen ====

Alle Template Dateien enthalten die Erzeugung der Kategoriefilter, Herstellerfilter, Preisfilter und sonstiger Attributsfilter.

Der Filterbereich besteht aus zwei Teilen:
  * bereits ausgewählte Filter, um sie wieder zu entfernen
  * zur Auswahl stehende Filter
  * irrelevante Filter, die die gesamte Ergebnismenge enthalten

Die folgenden smarty-Variablen werden dafür gesetzt:
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''CHOSEN_FILTERS'' | array | Array der bereits ausgewählten Filter |
| ''CATEGORY_CHOSEN_FILTERS'' | array | Array der bereits ausgewählten Kategoriefilter |
| ''COMPANY_CHOSEN_FILTERS'' | array | Array der bereits ausgewählten Herstellerfilter |
| ''PRICE_CHOSEN_FILTERS'' | array | Array der bereits ausgewählten Preisfilter |
| ''FILTERS'' | array | Array aller auswählbarer Filter |
| ''REDUNDANT_FILTERS'' | array | Array der irrelevanten Filter |

=== Items aller CHOSEN_FILTERS Arrays ===
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''ITEM.name'' | string | Name des ausgewählten Filters, z.B.: ''Farbe'' |
| ''ITEM.display'' | string | Die anzuzeigende Zeichenkette des ausgewählten Filters |
| ''ITEM.link'' | string | URL zu den Suchergebnissen, mit diesem Filter entfernt |
| ''ITEM.value'' | string | Wert des ausgewählten Filters, z.B.: ''rot'' |

<note tip>
Um zu prüfen, ob ein bestimmter Filter gesetzt ist (z.B. Farbe=rot) können Sie folgenden Code verwenden:

<code smarty>
$CHOSEN_FILTERS.Farbe[0].value == 'rot'
</code>

</note>

=== Erweiterung der Items von Bereichsfiltern (Beispielsweise Preisfilter) ===
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''ITEM.params.min'' | string | Minimum des Bereichsfilters |
| ''ITEM.params.max'' | string | Maximum des Bereichsfilters |

==== ====

Sie können auf die Struktur der auswählbaren Filter beispielsweise auf folgende Art zugreifen:

^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''FILTERS.cat.filters'' | array | Array der auswählbaren Kategoriefilter |
| ''FILTERS.vendor.filters'' | array | Array der auswählbaren Herstellerfilter |
| ''FILTERS.price.filters'' | array | Array der auswählbaren Preisfilter |

=== Items der Arrays der auswählbaren Filter ===
^ Variable ^ Typ ^ Kurzbeschreibung ^
| ''ITEM.name'' | string | Name des Fiters, z.B. ''Kategorie'' |
| ''ITEM.depth'' | string | Tiefe innerhalb einer Filterhierarchie |
| ''ITEM.frequency'' | integer | absolute Häufigkeit von Artikeln mit diesem Filter im Suchergebnis |
| ''ITEM.weight'' | number | relatives Gewicht dieses Filters etwa für die Tag-Cloud-Darstellung |
| ''ITEM.link'' | string |  URL Query String zu den zu den Suchergebnissen, mit diesem Filter zusätzlich ausgewählt |
| ''ITEM.params[0]'' | string | Wert des Filters (z.B. "rot") |


==== Paginator Variablen ====
Die Datei **paginator.tpl** enthält die Erzeugung der Ergebnisseitenauswahl am Anfang und am Ende der Suchergebnisse. Code-Bsp:[[https://secure.findologic.com/dokuwiki/doku.php?id=fl:internal:support:paginator_mit_pfeilen|Paginator mit Pfeilen]]

^ Variable ^ Typ ^ Beschreibung ^
| ''SHOW_FROM'' | integer | Nummer des erst angezeigten Artikels, 1 basiert |
| ''SHOW_TO'' | integer | Nummer des letzt angezeigten Artikels, 1 basiert |
| ''TOTAL_PAGES'' | integer | Die Gesamtanzahl der Seiten (inkl. der aktuellen) |
| ''CURRENT_PAGE'' | integer | Nummer der aktuelle Seite, 1 basiert |
| ''PREVIOUS_PAGES'' | array | Array von Seiten vor der aktuellen Seite |
| ''PREVIOUS_PAGE'' | array | Enthält Informationen über die vorherige Seite, falls gewählte Seite > 1 |
| ''NEXT_PAGES'' | array | Array von Seiten nach der aktuellen Seite |
| ''NEXT_PAGE'' | array | Enthält Informationen über die nächste Seite, falls gewählte Seite < letzte Seite |

=== Item in dem PREVIOUS_PAGES Array / PREVIOUS_PAGE ===
^ Variable ^ Typ ^ Beschreibung ^
| ''ITEM.NAME'' | string | Name der Seite |
| ''ITEM.URL'' | string | URL zu den Suchergebnissen, mit der Seite ausgewählt |

=== Item in dem NEXT_PAGES Array / NEXT_PAGE ===
Dieses Array hat den gleichen Aufbau, wie das ''PREVIOUS_PAGES'' Array.

====== Weiterführende Dokumentation ======

  * Allgemeines
    * [[fl:integration:eigenes_sonstiges|Übersicht]]
    * [[fl:integration:checklist_modul|Checklist]]
  * Export
    * [[fl:integration:export|Export Dokumentation]]
    * [[fl:csv_format_2_0|CSV Formatbeschreibung]]
  * Request
    * [[fl:integration:request|Dokumentation des Requests]]
  * Rückgabe
    * [[fl:integration:response:xml|Beschreibung des XML Formats]]
    * [[fl:integration:response:html|Dokumentation der HTML Rückgabe]]
    * [[fl:template_manager_2_0|Beschreibung der Templates]]
  * Smart Suggest 
    * [[fl:integration:smart_suggest|Einbindung der Smart Suggest]]
  * Navigation
    * [[fl:navigation|Implementierungsanleitung der Navigation]]